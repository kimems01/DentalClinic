@model HMS.Models.PatientInfoViewModel.PatientInfoCRUDViewModel

@functions {
    public int? CalculateAge(DateTime? dob)
    {
        if (!dob.HasValue) return null;

        var today = DateTime.Today;
        var age = today.Year - dob.Value.Year;
        if (dob.Value.Date > today.AddYears(-age)) age--;
        return age;
    }
}


@{
    var selectedEmploymentCompany = "";
    foreach (var item in ViewBag._EmploymentCompanies as List<SelectListItem>)
    {
        if (item.Value == Model.EmploymentCompany.ToString())
        {
            selectedEmploymentCompany = item.Text;
            break;
        }
    }
    
    var selectedInsuranceCompany = "";
    foreach (var item in ViewBag._InsuranceCompanies as List<SelectListItem>)
    {
        if (item.Value == Model.InsuranceCompany.ToString())
        {
            selectedInsuranceCompany = item.Text;
            break;
        }
    }

    var selectedFamily = "";
    foreach (var item in ViewBag._Families as List<SelectListItem>)
    {
        if (item.Value == Model.Family.ToString())
        {
            selectedFamily = item.Text;
            break;
        }
    }
}

<div class="row">
    <div class="col-md-12">
        <table class="ItemTranTable">
            <tr><th>Id</th><td>@Model.Id</td></tr>
            <tr><th>Patient Code</th><td>@Model.PatientCode</td></tr>
            <tr><th>ApplicationUser Id</th><td>@Model.ApplicationUserId</td></tr>
            <tr><th>Other Names</th><td>@Model.OtherNames</td></tr>
            <tr><th>Surname</th><td>@Model.Surname</td></tr>
            <tr><th>Marital Status</th><td>@Model.MaritalStatus</td></tr>
            <tr><th>Gender</th><td>@Model.Gender</td></tr>
            <tr><th>Spouse Name</th><td>@Model.SpouseName</td></tr>
            <tr><th>Blood Group</th><td>@Model.BloodGroup</td></tr>
            <tr><th>Age</th><td>@CalculateAge(Model.DateOfBirth)</td></tr>
            <tr><th>Date Of Birth</th><td>@Model.DateOfBirth</td></tr>
            <tr><th>Registration Fee</th><td>@Model.RegistrationFee</td></tr>
            <tr><th>Phone</th><td>@Model.Phone</td></tr>
            <tr><th>Email</th><td>@Model.Email</td></tr>
            <tr><th>Address</th><td>@Model.Address</td></tr>
            <tr><th>Country</th><td>@Model.Country</td></tr>
            <tr><th>Agreement</th><td>@Model.Agreement</td></tr>
            <tr><th>Remarks</th><td>@Model.Remarks</td></tr>
            <tr><th>National ID</th><td>@Model.NationalID</td></tr>
            <tr><th>Family</th><td>@selectedFamily</td></tr>
            <tr><th>Employment Company</th><td>@selectedEmploymentCompany</td></tr>
            <tr><th>Insurance Company</th><td>@selectedInsuranceCompany</td></tr>
            <tr><th>Residence</th><td>@Model.Residence</td></tr>
            <tr><th>Payment Mode</th><td>@Model.PaymentMode</td></tr>
            <tr><th>Guardian Name</th><td>@Model.GuardianName</td></tr>
            <tr><th>Guardian Phone</th><td>@Model.GuardianPhone</td></tr>
            <tr><th>Guardian Relationship</th><td>@Model.GuardianRelationship</td></tr>
            <tr><th>Profile Picture</th><td>@Model.ProfilePicture</td></tr>
            <tr><th>Created Date</th><td>@Model.CreatedDate</td></tr>
            <tr><th>Modified Date</th><td>@Model.ModifiedDate</td></tr>
            <tr><th>Created By</th><td>@Model.CreatedBy</td></tr>
            <tr><th>Modified By</th><td>@Model.ModifiedBy</td></tr>
        </table>
    </div>
</div>
